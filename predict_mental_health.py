# -*- coding: utf-8 -*-
"""predict_mental_health.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1hPkgoPo01fbA9ZkCsP6JxakAgu5yJ7y3
"""

import joblib
import pandas as pd

model = joblib.load('best_model.pkl')
scaler = joblib.load('scaler.pkl')
poly = joblib.load('poly.pkl')
feature_names = joblib.load('feature_names.pkl')

# Input new symptom data
new_data = pd.DataFrame([{
    'Age': 44,
    'work_interfere': 2,
    'family_history': 0,
    'mental_health_consequence': 0,
    'seek_help': 0,
    'Gender': 1,
    'mental_health_interview': 1,
    'mental_vs_physical': 0,
    'no_employees': 5,
    'remote_work': 0
}])

# Ensure the order of columns in new_data matches the training data
new_data = new_data[feature_names.tolist()]  # Reordering columns

# Scale the input data using the loaded scaler
# Including all original numerical columns for scaling
numerical_features = ['Age', 'work_interfere', 'family_history',
                     'mental_health_consequence', 'seek_help', 'Gender',
                     'mental_health_interview', 'mental_vs_physical',
                     'no_employees', 'remote_work']
new_data[numerical_features] = scaler.transform(new_data[numerical_features])

# Transform the new data using the same PolynomialFeatures object
new_data_poly = poly.transform(new_data)

# Make a prediction using the transformed data
prediction = model.predict(new_data_poly)
print(f"Predicted treatment: {prediction}")